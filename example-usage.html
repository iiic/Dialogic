<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>Notific html example</title>
	<!-- <link rel="stylesheet" href="/notific.css" crossorigin="anonymous" integrity="sha256-DErgeoS4SQg0UMgS8E4mhJbyqNPHbyooBGsPqlRQviw="> -->
</head>

<body>

	<!-- <h1>Notific v 0.3</h1>
	<p>On page or native Notifications</p>
	<p>Just vanilla javascript, no <s>jQuery</s> or other libraries. Styles and examples included in repo. Same parameters as browser's default <code>Notification()</code> function</p>
	<strong>Whats happening?</strong>
	<p>This page is showing notifications periodically every 8 seconds, and automatically hide them 15 seconds from display. (so max 2 notifications at the same tame).</p>
	<p>When tab is active notification is on page, when you switch to another tab, notifications will be shown by browser <code>Notification()</code> function.</p>
	<p>If native notifications are not working <button id="get-notification-permission">Get permissions for <code>Nofification()</code> by clicking this button</button></p>
	<p>The described behavior can be changed using the settings by inlined <code>text/json</code> object.</p>
	<hr>
	<h2 id="possible-problems">Possible problems?</h2>
	<p>The mjs extension must have the correct mime type set to <code>text/javascript</code>, if it is too laborious, rename the suffix from <code>.mjs</code> to <code>.js</code>.</p>
	<h2 id="services">Services</h2>
	<p>Unpkg: <a href="https://unpkg.com/notific-on-page-or-native-notifications">https://unpkg.com/notific-on-page-or-native-notifications</a></p>
	<p>NPM: <a href="https://www.npmjs.com/package/notific-on-page-or-native-notifications">https://www.npmjs.com/package/notific-on-page-or-native-notifications</a></p>
	<h2 id="licence">Licence</h2>
	<p><strong>CC BY-SA 4.0</strong></p>
	<p>This work is licensed under the Creative Commons Attribution-ShareAlike 4.0 International License. To view a copy of this license, visit <a href="http://creativecommons.org/licenses/by-sa/4.0/">http://creativecommons.org/licenses/by-sa/4.0/</a> or send a letter to Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.</p>
	<hr>
	<p>For more info:</p>
	<ul>
		<li>Readme in standalone file <a href="/README.md">/README.md</a></li>
		<li>Repo on <a href="https://github.com/iiic/notific">Github</a></li>
		<li>Webpage about function <a href="https://iiic.dev/notific-on-page-or-native-notifications">https://iiic.dev/notific-on-page-or-native-notifications</a></li>
	</ul> -->

	<div id="dialogic-root" hidden></div>
	<script type="text/json" id="dialogic-settings">
		{
			"modulesImportPath": "/modules",
			"askForPermissionsId": "get-notification-permission",
			"texts": {
				"defaultImageAlt": "default text for image… maybe default image",
				"askPermissionsResultSuccess": "Now you can receive browser Notifications.",
				"askPermissionsResultCanceled": "You canceled the possibility to display Notifications, this status is now remembered in the browser, to re-enable it, click on the small lock icon in front of the url address of this page and select allowed or ask.",
				"permissionsResultAlreadyGranted": "You have already allowed the default browser Notification."
			}
		}
	</script>
	<!-- <script type="module" src="dialogic.mjs?v=0.1" crossorigin="anonymous" data-integrity="sha256-todo"></script> -->
	<script type="module">
		//https://github.com/wootzapp/wootz-browser/blob/11f9323feb5ef4ab7dc420d7c3e9dbe372d868b3/js/web_notification.js#L18

		const DialogicInternal = class {

		}

		export class Dialogic extends DialogicInternal {

			constructor ( /** @type {String} */ title = '', /** @type {Object} */ options = {} ) {
				super();
				if ( arguments.length === 0 )
				{
					throw new TypeError( 'Failed to construct \'Dialogic\': 1 argument required, but only 0 present.' );
				}

				/** @type {Object} */
				const defaultOptions = {
					actions: [],
					badge: '',
					body: '',
					data: null,
					dir: 'auto',
					icon: '',
					image: null,
					lang: '',
					renotify: false,
					requireInteraction: false,
					silent: false,
					tag: '',
					timestamp: Date.now(),
					vibrate: []
				};

				options = options === null ? defaultOptions : { ...defaultOptions, ...options };

				/** @param title */
				Object.defineProperty( this, 'title', {
					value: title,
					writable: false,
					enumerable: true,
					configurable: true
				} );

				this.onclick = null;
				this.onclose = null;
				this.onerror = null;
				this.onshow = null;

				if ( options !== null )
				{

					/** @type {Array} */
					const keys = Object.keys( defaultOptions );

					keys.forEach( ( /** @type {String} */ key ) => {
						Object.defineProperty( this, key, {
							value: options[ key ],
							writable: false,
							enumerable: true,
							configurable: true
						} );
					} );
				}

			}

			close () {
				const event = new Event( 'close' );
				this.dispatchEvent( event );
				if ( this.onclose !== null )
				{
					this.onclose( event );
				}
			}

			run () {
				// …
			}

		}

		// Private properties
		Object.defineProperty( Dialogic, 'maxActions', {
			get: function () {
				return 2;
			},
			set: function () { },
			enumerable: true
		} );

		window.Dialogic = Dialogic;

		// const lol = new Dialogic( 'nadpis' );
		// console.log( lol );
	</script>
